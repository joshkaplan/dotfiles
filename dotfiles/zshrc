# ZSH Config
# Josh Kaplan

export ZSH=$HOME/.oh-my-zsh
export PGDATA="/usr/local/var/postgres" # Postgres
export SSH_KEY_PATH="~/.ssh/dsa_id" # SSH
# PATH
export PATH="/usr/local/bin:/usr/local/sbin:~/bin:$PATH" # Homebrew
# Editors
export EDITOR=vim
export VISUAL=vim

ZSH_THEME="powerlevel10k"
DEFAULT_USER="josh"
ENABLE_CORRECTION="true" # Auto Correct
VIRTUAL_ENV_DISABLE_PROMPT="true"

# LIBRARIES 
##############################

# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

# oh-my-zsh
plugins=(git sublime osx)
source $ZSH/oh-my-zsh.sh

# p10k configuration (originally; generated by `p10k configure`)
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh

# Shell integration
test -e "${HOME}/.iterm2_shell_integration.zsh" && source "${HOME}/.iterm2_shell_integration.zsh"

# rbenv (ruby)
eval "$(rbenv init -)"

# Github
eval "$(hub alias -s)"

# nvm
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion

# virtualenv
export WORKON_HOME=~/graphiq/venvs
export VIRTUALENVWRAPPER_PYTHON=/usr/local/bin/python3
[ -f /usr/local/bin/virtualenvwrapper.sh ] && source /usr/local/bin/virtualenvwrapper.sh

# SETTINGS
##############################

# Vim Keybindings
bindkey -v

# Separate Histories
unsetopt inc_append_history
unsetopt share_history

# Online Help
# unalias run-help
autoload run-help
HELPDIR=/usr/local/share/zsh/help

# Auto Completion
zmodload zsh/complist
bindkey -M menuselect ' ' accept-and-infer-next-history
bindkey -M menuselect '^?' undo

# More completions
fpath=(~/.zsh/completion $fpath)
autoload -Uz compinit && compinit -i

# SOURCE MORE STUFF
##############################

# Aliases (sourced near the end so they override other defaults)
source ~/.dotfiles/dotfiles/aliases.zsh

# Local overrides
if [ -e ~/.local.zsh ]; then
    source ~/.local.zsh
fi
